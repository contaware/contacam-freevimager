<html dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><meta name="MS.LOCALE" content="en-us"><title>biHeight and Video Formats in DirectShow</title><meta name="description" content="Discusses video capture driver issues and presents a set of rules to follow to ensure correct image orientation"><meta name="keywords" content="inverted video images, DirectShow, video capture driver, VfW, Video for Windows, image inversion, biHeight, "><meta name="search.mnp.template" content="MNP2.GenericArticle"><link type="text/css" rel="Stylesheet" href="biheight%20Sign%20Problem_files/templatecss.css">
<script type="text/javascript" language="Javascript" src="biheight%20Sign%20Problem_files/menujs"></script>
<link type="text/css" rel="Stylesheet" href="biheight%20Sign%20Problem_files/css_002.css">
<link rel="stylesheet" type="text/css" href="biheight%20Sign%20Problem_files/css.css"><script language="JavaScript">var doImage=doImage;var TType=TType;
function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}
function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=www&TYPE=' + tt + '&p=whdc_archive&URI=%2fwhdc%2farchive%2fbiheight.mspx&GUID=1F4FC18C-F71E-47FB-8FC9-612F8EE59C61&lc=en-us" width=0 height=0 hspace=0 vspace=0 border=0 alt=""/></div></layer>');}}msvi_qllc = "en-us";msvi_qldir = "LTR";msvi_qlhost = "http://www.microsoft.com";</script><meta name="WT.sp" content="_whdc_"><meta name="DCSext.ismnp" content="1"><script language="JavaScript" src="biheight%20Sign%20Problem_files/broker.js"></script><link rel="stylesheet" type="text/css" href="biheight%20Sign%20Problem_files/ql.css"><script type="text/javascript" src="biheight%20Sign%20Problem_files/ql.js"></script><script language="Javascript">
					if (self.name == "MNPMainFrame") top.location.href = self.location.href;
				</script><meta name="save" content="favorite"></head><body topmargin="0" leftmargin="0" bgcolor="#ffffff" marginheight="0" marginwidth="0"><!--NOINDEX_START--><a name="top"></a><div id="msviMasthead"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td width="100%"><table border="0" cellpadding="0" cellspacing="0" height="22" width="100%"><tbody><tr><td id="msviRegionIdGraphic" bgcolor="#ffffff"></td><td bgcolor="#6487db" width="100%"><img src="biheight%20Sign%20Problem_files/gradient_002.jpg" alt="*" title="" height="22" width="250"></td></tr></tbody></table></td><td id="msviGlobalToolbar" dir="ltr" align="left" bgcolor="#6487db" height="22" nowrap="nowrap"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="panelTd" class="gt0" nowrap="nowrap"><a href="javascript:void(0)">Quick Links&nbsp;</a><script>document.write('<img src="/library/mnp/2/gif/ql.gif" width="11px" height="4px" alt="">');</script><img src="biheight%20Sign%20Problem_files/ql.gif" alt="" height="4" width="11"><div id="panelDiv" style="position: absolute; visibility: hidden; z-index: 100;"></div></td><td class="gtsep">|</td><td class="gt0" onmouseover="this.className='gt1'" onmouseout="this.className='gt0'" nowrap="nowrap"><a href="http://go.microsoft.com/?linkid=4412890">Home</a></td><td class="gtsep">|</td><td class="gt0" onmouseover="this.className='gt1'" onmouseout="this.className='gt0'" nowrap="nowrap"><a href="http://go.microsoft.com/?linkid=4412891">Worldwide</a></td><td class="msviPPSpace"></td></tr></tbody></table></td></tr></tbody></table><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr valign="top"><td width="100%"><table style="" border="0" cellpadding="0" cellspacing="0" height="42" width="100%"><tbody><tr valign="top"><td id="msviBrandBanner" bgcolor="#ffffff"><a href="http://www.microsoft.com/windows"><img src="biheight%20Sign%20Problem_files/windows_masthead_ltr.gif" alt="Windows" title="" border="0" height="42" width="225"></a></td><td bgcolor="#b6c5ee" width="100%"><img src="biheight%20Sign%20Problem_files/gradient.jpg" alt="*" title="" height="42" width="250"></td></tr></tbody></table></td><td id="msviGlobalSearch" bgcolor="#b6c5ee">Search Microsoft.com for:<br><form id="msviSearchForm" action="/library/toolbar/3.0/search.aspx" target="_top"><input name="View" value="en-us" type="hidden"><input name="charset" value="iso-8859-1" type="hidden"><nobr><div style="height: 18px;"><input name="qu" id="msviSearchBox" maxlength="255"><input id="msviGoButton" value="Go" type="submit"></div></nobr></form></td></tr></tbody></table><table id="msviSubbanner" bgcolor="#5076c9" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><img src="biheight%20Sign%20Problem_files/subbanner.jpg" alt="Windows Hardware Developer Central" title="" border="0" height="26" width="467"></td><td width="100%">&nbsp;</td></tr></tbody></table><div id="msviLocalToolbar"><table border="0" cellpadding="0" cellspacing="0" height="19" width="100%"><tbody><tr><td id="msviHomePageLink" nowrap="nowrap"><a href="http://www.microsoft.com/whdc/default.mspx">WHDC Home</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/japan/whdc/" target="_blank">WHDC Japan</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 4, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 4, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/Taiwan/whdc/" target="_blank">WHDC Taiwan</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 6, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 6, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/whdc/sitemap.mspx">WHDC Site Map</a></td><td width="100%"></td></tr></tbody></table></div></div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr valign="top"><td style="overflow-x: hidden;" height="100%" width="181"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="mnpQuickSearch" style="background: rgb(204, 204, 204) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(0, 0, 0);" dir="ltr"><form style="margin: 0px;" action="/whdc/simplesearch.aspx"><nobr><font color="#000000">Search WHDC for</font><br><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="mnpQuickSearch" style="padding: 0px;"><span style="width: 137px;"><input class="mnpSearchBox" id="qu" name="qu" maxlength="255" style="width: 100%;" type="text"></span></td><td><input class="mnpSearchButton" value="Go" type="submit"><br></td></tr></tbody></table></nobr></form></td></tr></tbody></table><div id="mnpMenuTop" class="mnpMenuTop" style="overflow-x: hidden; width: 181px;" url="/whdc/archive/biheight.mspx" dir="ltr" parent="/whdc/archive/default.mspx"><div class="mnpInherit"><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/resources/current.mspx">What's New</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="m10b0105d1304bd7a0f56172ce909e12a"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/system/default.mspx">PC Fundamentals</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="m9bba6c84c217a460369e94ba23cef969"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/device/default.mspx">Device Fundamentals</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="mb0cc768b1298027b621b031f6ac60875"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/driver/default.mspx">Driver Fundamentals</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="mef4848974a184dedd092d96b8e7ed272"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/DevTools/default.mspx">WDK and Developer Tools</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="mcddbd1f2e034c8725ff4dbbd36baab91"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/resources/default.mspx">Developer Community</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="mcb3799b6e8634d6780b0fa8c0a0de420"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/winlogo/default.mspx">Windows Logo and Driver Signing</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="ma342df9dde3515be1415f40fcef58f3b"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/whql/default.mspx">WHQL Testing and Winqual Services</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="m10c2e1bb21b8ed527d56b9fb9ee2d7f8"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/winhec/default.mspx">WinHEC</a></div><div class="mnpMenuBorder" style="width: 180px;"></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="me7feb252a4f7596c96962604562ff957"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/xps/default.mspx">XPS</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="ma1cc41ded5e4459bb2930677bc359301"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/rally/default.mspx">Windows Rally</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 153px; overflow-x: hidden;" menu="mdb6b0e129db009206b14b7b84168a7d9"><img alt="*" title="" class="mnpMenuArrow" src="biheight%20Sign%20Problem_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" border="0" height="7" width="4"><a href="http://www.microsoft.com/whdc/flexgo/default.mspx">Microsoft FlexGo</a></div><div class="mnpMenuBorder" style="width: 180px; margin-bottom: 0px;"></div></div></div><div class="mnpAds" style="border-style: solid; border-color: rgb(153, 153, 153); border-width: 0px 1px 0px 0px; background: rgb(241, 241, 241) none repeat scroll 0%; width: 181px; height: 100%; padding-bottom: 20px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><center><div style="background: inherit inherit inherit inherit inherit; height: 20px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"></div><a href="http://shop.ecompanystore.com/mseventdvd/MSD_Shop.asp" target="_blank">
        <img src="biheight%20Sign%20Problem_files/120x90_WH06dvd.gif" alt="WinHEC 2006 on DVD" border="0">
      </a><br><div style="background: inherit inherit inherit inherit inherit; height: 20px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"></div><a href="http://www.microsoft.com/whdc/winlogo/WLP30.mspx">
        <img src="biheight%20Sign%20Problem_files/120x90_WinLogo3.gif" alt="Windows Logo Program 3.0" border="0">
      </a><br></center></div></td><td dir="ltr" width="100%">
<div style="padding: 0px 15px 0px 20px;"><h1>biHeight and Video Formats in DirectShow</h1><div class="date">Updated: December 4, 2001</div><div class="overview"><img src="biheight%20Sign%20Problem_files/wparchive.gif" alt="" border="0" height="40" width="260"><span id="ctl09_PrinterText"></span>
</div><center><img src="biheight%20Sign%20Problem_files/3squares.gif" alt="*" title="" border="0" height="6" width="30"></center><div style="height: 18px;"></div><h5 style="padding-top: 2px;">On This Page</h5><table style="margin-top: 7px; margin-bottom: 12px;" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td><a href="#E4"><img src="biheight%20Sign%20Problem_files/arrow_px_down.gif" alt="Background of the Image Inversion Problem" border="0" height="9" hspace="4" vspace="2" width="7"></a></td><td class="onThisPage"><a href="#E4">Background of the Image Inversion Problem</a></td></tr><tr valign="top"><td><a href="#EKB"><img src="biheight%20Sign%20Problem_files/arrow_px_down.gif" alt="Where Image Inversion Occurs" border="0" height="9" hspace="4" vspace="2" width="7"></a></td><td class="onThisPage"><a href="#EKB">Where Image Inversion Occurs</a></td></tr><tr valign="top"><td><a href="#EPB"><img src="biheight%20Sign%20Problem_files/arrow_px_down.gif" alt="Where Image Inversion is Not a Problem" border="0" height="9" hspace="4" vspace="2" width="7"></a></td><td class="onThisPage"><a href="#EPB">Where Image Inversion is Not a Problem</a></td></tr><tr valign="top"><td><a href="#ETB"><img src="biheight%20Sign%20Problem_files/arrow_px_down.gif" alt="Proposed Solution for biHeight Problem" border="0" height="9" hspace="4" vspace="2" width="7"></a></td><td class="onThisPage"><a href="#ETB">Proposed Solution for biHeight Problem</a></td></tr></tbody></table><a name="EY"></a><h2></h2><p>A
problem with inverted video images in the capture, compression, and
display of video in Video for Windows® (VfW) and Microsoft® DirectShow®
requires the collective efforts of video-capture IHVs to solve. The
problem is related to inconsistent use of the biHeight variable, which
is part of the BITMAPINFOHEADER structure in GDI and the
VIDEOINFOHEADER structure in DirectShow.</p><p>This article is for IHVs
who have written a video capture driver or codec and for ISVs whose
applications work with images at the image level, such as digital video
editors. This article discusses the issues and presents a set of rules
to follow to ensure correct image orientation.</p><p>Inconsistent use
of both image orientation and of biHeight to describe orientation by
components such as capture drivers and rendering filters can cause
inverted images when these components are directly connected in a
DirectShow filter graph.</p><p>Resolving this problem will allow the
video capture industry to achieve consistency among devices for proper
orientation of images and for use of biHeight to describe orientation.
Direct connection of a capture device to a rendering device can also
result in improved video performance, because the ability to transfer
an image directly to the Microsoft DirectDraw surface avoids a buffer
copy operation.</p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="biheight%20Sign%20Problem_files/arrow_px_up.gif" alt="Top of page" border="0" height="9" width="7"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="E4"></a><h2>Background of the Image Inversion Problem</h2><p>Video
capture began in Windows with VfW, which initially only used
red-green-blue (RGB) images identified with a +biHeight and a bottom-up
orientation. This follows conventions used in standard
device-independent bitmaps. </p><p>Later, some VfW capture drivers
produced YUV and other formats with a top-down orientation, which means
the lowest video address is in the upper-left corner but still uses
+biHeight. In VfW, YUV data produced by a capture driver always passes
through a codec provided by the vendor, resulting in RGB. Because
codecs were required components for capture drivers that produced YUV
data, some capture driver writers also felt safe in using the codec to
correct inverted images. </p><p>DirectDraw also defines a top-down
image orientation but does not use a BITMAPINFOHEADER structure to
describe its surfaces. DirectShow (the service that allows a capture
driver to connect directly to a renderer) passes one of these
DirectDraw surfaces to a component such as a codec to fill in.
DirectShow determines whether the orientation is top-down or bottom-up,
and it advertises the biHeight value that corresponds to that
orientation.</p><p>When DirectShow provides DirectDraw rendering
surfaces (which always use a top-down orientation), it follows
convention by advertising a -biHeight so the codec or capture driver
knows that the lowest video address is in the upper-left corner. If the
source does not follow convention and instead supplies video in a
bottom-up orientation to the renderer, then the image is inverted.</p><p></p><p><img src="biheight%20Sign%20Problem_files/biheight.gif" alt="" border="0" height="102" width="220"></p><p></p><p>Inconsistent
exposure of biHeight values in capture drivers and codecs that are
components in DirectShow filter graphs can result in upside-down images
when this video source connects directly to a renderer that is
rendering onto a DirectDraw surface.</p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="biheight%20Sign%20Problem_files/arrow_px_up.gif" alt="Top of page" border="0" height="9" width="7"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="EKB"></a><h2>Where Image Inversion Occurs</h2><p>Image
inversion can occur where software components hosted in a DirectShow
filter graph produce a video format whose properties exactly match the
format properties of the DirectDraw surface to which they are connected.</p><p>For
example, consider a capture driver that is typically connected to a
codec that corrects the inverted video by flipping the image before the
image is displayed. If this capture driver is used in a DirectShow
filter graph--and if DirectShow determines that the capture driver
format properties exactly match format properties that the DirectDraw
renderer accepts--then DirectShow will connect the capture driver to
the renderer without using the codec. Without the codec, the image will
not be flipped and therefore will be displayed upside down.</p><p>In
this example, DirectShow eliminated the codec and avoided a buffer copy
operation. DirectShow has no way of determining that the capture driver
used biHeight differently to describe its orientation, resulting in
inverted video. Any video format exposed by a driver and also supported
as a DirectDraw surface format can have this problem.</p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="biheight%20Sign%20Problem_files/arrow_px_up.gif" alt="Top of page" border="0" height="9" width="7"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="EPB"></a><h2>Where Image Inversion is Not a Problem</h2><p>Image
inversion is not a problem for VfW capture drivers used only within a
VfW environment, because data produced by a capture driver always
passes through a codec supplied by the same vendor. This codec treats
the data as a private format and does whatever is necessary to support
the +biHeight format required by VfW.</p><p>Image inversion is also not
a problem for drivers that produce private compressed formats, because
their data must always be sent through a codec for decompression and
rendering. JPEG, which is always encoded with a +biHeight, is an
example of a private format.</p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="biheight%20Sign%20Problem_files/arrow_px_up.gif" alt="Top of page" border="0" height="9" width="7"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="ETB"></a><h2>Proposed Solution for biHeight Problem</h2><p>The following rules are proposed to solve this problem:</p><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="listBullet" valign="top">&#8226;</td><td class="listItem"><p>RGB
pixel formats can be described with a BITMAPINFOHEADER that has a
-biHeight value to indicate that the vertical orientation of the image
is top-down. However, using the sign of biHeight to indicate
orientation is only valid for RGB (uncompressed) formats.<br>
For compression types described with a FOURCC code in the biCompression
field, the FOURCC code uniquely identifies the compression and
orientation. It is not valid to describe the orientation with the sign
of biHeight. <br><br>
For backward compatibility, WDM-based capture minidrivers are strongly recommended to advertise +biHeight for RGB.<br></p></td></tr><tr><td class="listBullet" valign="top">&#8226;</td><td class="listItem"><p>Common
YUV formats such as UYVY, YV12, and YUY2 are top-down oriented. It is
invalid to store an image with these compression types in bottom-up
orientation. The sign of biHeight for such formats must always be set
as positive by drivers producing such formats, and the sign must be
ignored by any driver receiving such formats. </p><p>For proprietary compression formats with an associated FOURCC,
any orientation is acceptable, but must always be the same for all
bitmaps of that FOURCC.</p><p></p></td></tr></tbody></table><p><b>Call to action for biHeight problem:</b></p><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="listBullet" valign="top">&#8226;</td><td class="listItem"><p>If
you are a hardware or software vendor creating video capture and
display components that do not use private compressed formats, follow
the proposed rules to ensure correct image orientation.</p></td></tr></tbody></table><br style="font-size: 0pt;" clear="all"><div style="margin-top: 16px; margin-bottom: 20px; width: 100%;"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><a href="#top"><img src="biheight%20Sign%20Problem_files/arrow_px_up.gif" alt="Top of page" border="0" height="9" width="7"></a><a class="topOfPage" href="#top">Top of page</a></td></tr></tbody></table></div></div></td></tr></tbody></table><br style="overflow: hidden; line-height: 1px;" clear="all"><table id="msviFooter" cellpadding="0" cellspacing="0" width="100%"><tbody><tr valign="bottom"><td id="msviFooter2" style=""><div id="msviLocalFooter"><nobr><a href="http://go.microsoft.com/?linkid=317027" target="_top">Manage Your Profile</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=2028383" target="_parent">Contact us</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/whdc/newsreq.mspx" target="_top">WHDC Newsletter</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/japan/whdc/" target="_parent">WHDC Japan</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/Taiwan/whdc/" target="_parent">WHDC Taiwan</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/whdc/Legend.mspx" target="_blank">WHDC Icon Key</a></nobr></div><div id="msviGlobalFooter"><span dir="ltr">© 2006 Microsoft Corporation. All rights reserved.&nbsp;</span><nobr><a href="http://go.microsoft.com/?linkid=4412892" target="_parent">Terms of Use</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=4412893" target="_parent">Trademarks</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=4412894" target="_parent">Privacy Statement</a></nobr></div></td><td bgcolor="#6487db" width="105"><img src="biheight%20Sign%20Problem_files/text.jpg" alt="Microsoft" title="" border="0" height="29" width="105"></td></tr></tbody></table><div style="display: none;"><script type="text/javascript">var gDomain="m.webtrends.com";var gDcsId="dcsjwb9vb00000c932fd0rjc7_5p3t";var gTrackEvents="1";var gFpc="WT_FPC";if(document.cookie.indexOf(gFpc+"=")==-1){document.write("<SCR"+"IPT TYPE='text/javascript' SRC='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'><\/SCR"+"IPT>");}</script><script src="biheight%20Sign%20Problem_files/wt.js" type="text/javascript"></script><noscript><img
border="0" name="DCSIMG" width="1" height="1"
src="http://m.webtrends.com/dcsjwb9vb00000c932fd0rjc7_5p3t/njs.gif?dcsuri=/nojavascript&WT.js=No"/></noscript></div><layer visibility="hide"></layer><div style="display: none;"><img alt="" src="biheight%20Sign%20Problem_files/trans_pixel.gif" border="0" height="0" hspace="0" vspace="0" width="0"></div></body></html>